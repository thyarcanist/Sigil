# SIGIL Benchmark vs. `generate_bit_viz.py` Visual Analysis Report (Local Engine)

## Objective

This report summarizes the findings from comparing the visual outputs (Bit Visualization, FFT Spectrum, Wavelet Decomposition) generated by the SIGIL `examples/benchmark_run.py` script (using the `--local-engine` flag) against reference outputs generated by the `src/idia/audit/generate_bit_viz.py` script (from the Idia project context), focusing on the `eris:raw` and `eris:full` entropy sources.

The goal was to understand discrepancies and ensure the SIGIL benchmark accurately reflects expected patterns based on the reference script, aligning with SIGIL's philosophy of interrogating randomness visually.

## Initial Observations

*   Initial runs of `benchmark_run.py` produced `eris:raw` visualizations (particularly FFT and Wavelet) that differed significantly from the reference `generate_bit_viz.py` outputs.
*   The reference `eris:raw` FFT showed distinct, strong vertical/columnar energy bands.
*   The reference `eris:raw` Wavelet showed a complete 4-level decomposition.
*   The benchmark's initial `eris:raw` FFT lacked the same structure and appeared shifted.
*   The benchmark's initial `eris:raw` Wavelet plot only showed the final approximation (LL) block.
*   A reference `eris:full` FFT image showed a mostly flat spectrum characteristic of whitened data, but with a distinct single bright pixel artifact at the center (DC component).
*   The benchmark's `eris:full` FFT (generated locally via QRNG + whitening/BTQE) was also flat but consistently lacked the central artifact.

## Alignment Process

Several steps were taken to align `benchmark_run.py` with `generate_bit_viz.py`:

1.  **Data Size:** Matched the number of bytes requested (1,152,000 bytes).
2.  **Image Dimensions:** Matched the visualization dimensions (3035x3035 pixels).
3.  **FFT Calculation:** Ensured `np.fft.fftshift` was applied and log scaling used.
4.  **Wavelet Calculation:** Replicated the `pywt.wavedec2` call and the multi-coefficient plotting logic from `generate_bit_viz.py`.
5.  **Bit Order:** Ensured both processes used LSB-first bit unpacking (matching `np.unpackbits` default).
6.  **Data Acquisition Path:** Initially different (direct QRNG call in benchmark vs. `EntropyAuditor` in `gen_viz`). The final alignment involved forcing the benchmark to use `EntropyAuditor` for the `eris:raw` path.

## Key Findings & Interpretations (Revised)

The core findings revolve around the significant impact of the data acquisition and processing pathway ("observation method") on both the statistical properties and visual characteristics of the `eris:raw` data.

### ERIS:raw - Three Distinct Pathways

We identified three primary pathways for accessing `eris:raw` data, each yielding different results:

1.  **Web API Path ("Not Looking Locally"):**
    *   *Method:* Fetching data via the `/api/eris/raw` endpoint.
    *   *Visuals:* Displays clear visual structure, notably distinct vertical banding in bit visualizations (e.g., `ERIS_raw_bit_visualization_2896x2896.png`). FFT likely shows corresponding structure.
    *   *Statistics:* Consistently **PASSES** standard statistical tests (Chi-Square, Monobit, Runs) even at significant sizes (e.g., 90,000 bytes).
    *   *Interpretation:* The API's internal processing delivers data labeled `raw` that retains visible structure but meets statistical uniformity criteria.

2.  **Direct Local Path ("Minimal Local Scrutiny"):**
    *   *Method:* Generating data locally and accessing it directly via `QuantumTrueRandomGenerator` (e.g., default `entropy_audit.py` run).
    *   *Visuals:* May show some structure, but potentially less pronounced or different from the API or Auditor paths.
    *   *Statistics:* Consistently **FAILS** standard statistical tests (e.g., 90 KiB `entropy_audit.py` run showed p=0.0000).
    *   *Interpretation:* Accessing the underlying generator's output directly reveals its inherent statistical weaknesses.

3.  **Auditor-Mediated Local Path ("Active Local Scrutiny"):**
    *   *Method:* Generating data locally but processing it through the `EntropyAuditor` class pathway (e.g., modified `benchmark_run.py --local-engine`, `generate_bit_viz.py`).
    *   *Visuals:* **Reveals/intensifies** specific visual structures, particularly the strong vertical bands in the FFT (e.g., `ERIS_raw_fft_spectrum_3035x3035.png`) and corresponding patterns in the bit visualization.
    *   *Statistics:* Data processed this way still **FAILS** standard statistical tests (confirmed by `ERIS_raw_analysis_summary.txt` for the 3035x3035 run).
    *   *Interpretation:* The `EntropyAuditor` acts as an "observational frame" or processing lens. It doesn't fix the statistical failures of the local raw data but *does* make its inherent structural patterns visually prominent.

**Summary of ERIS:raw Findings:** There's a clear correlation: local observation pathways (Direct and Auditor-Mediated) result in statistically **failing** data. The API pathway results in statistically **passing** data. Crucially, the Auditor-Mediated local path excels at **visually revealing** the underlying structure present in the statistically failing local data. This highlights the observer effect – the method of access/processing dictates the perceived properties.

### ERIS:full Visualization (Whitened Data)

*   **Whitening Effect Confirmed:** Whitening (`apply_full_whitening`/BTQE fallback) effectively removes the prominent raw structures (like vertical bands), resulting in visually flat FFTs and bit visualizations that appear more uniform, consistent with the data **passing** statistical tests.
*   **Subtle Artifacts & SIGIL Rationale:** Despite statistical uniformity, visual inspection of whitened data (`eris:full`) can reveal subtle artifacts (e.g., the missing central FFT dot compared to a reference image, potential "ghosts" mentioned in the SIGIL README). The process of enforcing uniformity via whitening doesn't necessarily erase *all* structural information; it may transform it or introduce new, subtle patterns. This persistence of subtle structure in statistically "perfect" data is the core motivation for SIGIL – to interrogate randomness beyond standard tests and detect potential leakage hidden in these residual artifacts.

### Core Hypothesis: Processing Reveals or Induces Structure

*   **Observer Dependence:** The `eris:raw` results demonstrate a strong dependence on the observation pathway. The API yields statistically passing data, while local paths yield statistically failing data, and the Auditor path specifically enhances visual detection of structure within that failing data.
*   **Whitening Transforms Structure:** The `eris:full` results show that whitening removes gross structures but may leave or create subtle ones. This aligns with the idea that enforcing uniformity can shift, rather than completely eliminate, structural information, potentially making different, subtler patterns apparent.
*   **Exploitable Information:** Both the inherent structure in raw data (revealed locally) and the subtle residual structures in whitened data could represent exploitable information leakage, justifying the need for deep visual and structural analysis beyond standard statistical testing.

## Conclusion (Revised)

The investigation confirmed significant differences in the characteristics of `eris:raw` data depending on the acquisition path (Web API vs. Direct Local vs. Auditor-Mediated Local). The Web API delivers statistically passing data despite visible structure, while local paths yield statistically failing data. The `EntropyAuditor` class, when used locally, acts as a specific observational frame that visually amplifies the inherent structures within the statistically failing raw data.

Furthermore, the analysis of `eris:full` demonstrates that while whitening removes dominant raw structures and ensures statistical uniformity, it may leave subtle visual artifacts. This reinforces the core premise of SIGIL: the need to interrogate randomness visually and structurally, even when it passes standard statistical tests, to detect potential hidden patterns or information leakage introduced or revealed by processing.

The observed observer dependence and the potential for residual structure after whitening underscore the value of a multi-modal analysis framework like SIGIL for comprehensive entropy assessment and security analysis. The ERIS generator, through its complex dynamics, produces output whose behavioral properties warrant such deep interrogation.
